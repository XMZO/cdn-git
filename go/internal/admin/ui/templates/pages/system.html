{{define "system"}}
  <div class="grid">
    <div class="card">
      <h2>{{.Title}}</h2>
      <div class="muted small">{{.T "system.subtitle"}}</div>
    </div>

    <div class="grid cols-2">
      <div class="card">
        <h3>{{.T "system.runtimeTitle"}}</h3>
        <div class="kvs">
          <div class="muted">{{.T "system.now"}}</div>
          <div><code>{{.Now}}</code></div>
          <div class="muted">{{.T "system.startedAt"}}</div>
          <div><code>{{.StartedAt}}</code></div>
          <div class="muted">{{.T "system.uptime"}}</div>
          <div><code>{{.Uptime}}</code></div>
          <div class="muted">{{.T "system.go"}}</div>
          <div><code>{{.GoVersion}}</code></div>
          <div class="muted">{{.T "system.build"}}</div>
          <div><code>{{.BuildVersion}}</code></div>
          <div class="muted">{{.T "system.sessionTTL"}}</div>
          <div><code>{{.SessionTTLSeconds}}</code> {{.T "system.seconds"}}</div>
        </div>
      </div>

      <div class="card">
        <h3>{{.T "system.configTitle"}}</h3>
        <div class="kvs">
          <div class="muted">{{.T "system.configUpdatedAt"}}</div>
          <div><code>{{.ConfigUpdatedAt}}</code></div>
          <div class="muted">{{.T "system.encryption"}}</div>
          <div>
            {{if .EncryptionEnabled}}
              <span class="pill ok">{{.T "common.enabled"}}</span>
            {{else}}
              <span class="pill err">{{.T "common.disabled"}}</span>
            {{end}}
          </div>
          <div class="muted">{{.T "system.sqlite"}}</div>
          <div><code>{{.DBPath}}</code></div>
          <div class="muted">{{.T "system.dbSize"}}</div>
          <div><code>{{.DBSize}}</code></div>
          <div class="muted">{{.T "system.adminUsers"}}</div>
          <div><code>{{.UsersCount}}</code></div>
          <div class="muted">{{.T "system.versionsCount"}}</div>
          <div><code>{{.VersionsCount}}</code></div>
          <div class="muted">{{.T "system.sessionsCount"}}</div>
          <div><code>{{.SessionsCount}}</code></div>
        </div>
        <div class="btn-row">
          <a class="btn" href="/config/versions">{{.T "nav.versions"}}</a>
          <a class="btn" href="/config/export" data-confirm-download="{{.T "backup.confirmTitle"}}" data-confirm-detail="{{.T "backup.confirmDetail"}}">{{.T "nav.export"}}</a>
        </div>
      </div>
    </div>

    <div class="card">
      <h3>{{.T "system.servicesTitle"}}</h3>
      <div class="muted small">{{.T "system.servicesHint"}}</div>

      <div class="grid cols-2" style="margin-top:12px;">
        <div class="card" style="padding:14px;">
          <h3 style="margin:0 0 6px;">Admin</h3>
          <div class="muted small">{{.T "common.port"}}：<code>{{.Ports.Admin}}</code></div>
          <div style="margin-top:8px;">{{template "serviceStatusPill" (statusCtx $ .AdminStatus)}}</div>
          {{if and (eq .AdminStatus.Status "error") .AdminStatus.Error}}
            <div class="muted small" style="margin-top:8px;">{{.T "common.errorPrefix"}}：{{.AdminStatus.Error}}</div>
          {{end}}
        </div>

        <div class="card" style="padding:14px;">
          <h3 style="margin:0 0 6px;">Torcherino</h3>
          <div class="muted small">{{.T "common.port"}}：<code>{{.Ports.Torcherino}}</code></div>
          <div style="margin-top:8px;">{{template "serviceStatusPill" (statusCtx $ .TorcherinoStatus)}}</div>
          {{if and (eq .TorcherinoStatus.Status "error") .TorcherinoStatus.Error}}
            <div class="muted small" style="margin-top:8px;">{{.T "common.errorPrefix"}}：{{.TorcherinoStatus.Error}}</div>
          {{end}}
        </div>

        <div class="card" style="padding:14px;">
          <h3 style="margin:0 0 6px;">{{.T "nav.cdnjs"}}</h3>
          <div class="muted small">{{.T "common.port"}}：<code>{{.Ports.Cdnjs}}</code></div>
          <div style="margin-top:8px;">{{template "serviceStatusPill" (statusCtx $ .CdnjsStatus)}}</div>
          {{if and (eq .CdnjsStatus.Status "error") .CdnjsStatus.Error}}
            <div class="muted small" style="margin-top:8px;">{{.T "common.errorPrefix"}}：{{.CdnjsStatus.Error}}</div>
          {{end}}
        </div>

        <div class="card" style="padding:14px;">
          <h3 style="margin:0 0 6px;">GitHub Raw</h3>
          <div class="muted small">{{.T "common.port"}}：<code>{{.Ports.Git}}</code></div>
          <div style="margin-top:8px;">{{template "serviceStatusPill" (statusCtx $ .GitStatus)}}</div>
          {{if and (eq .GitStatus.Status "error") .GitStatus.Error}}
            <div class="muted small" style="margin-top:8px;">{{.T "common.errorPrefix"}}：{{.GitStatus.Error}}</div>
          {{end}}
        </div>
      </div>
    </div>

    <div class="card">
      <h3>{{.T "system.redisTitle"}}</h3>

      {{if eq .Redis.Status "ok"}}
        <div class="pill ok">{{.T "redis.ok"}} · {{.Redis.LatencyMS}}ms · <code>{{.Redis.Addr}}</code></div>
        <div class="kvs" style="margin-top:12px;">
          <div class="muted">{{.T "system.redis.version"}}</div>
          <div>{{if .Redis.ServerVersion}}<code>{{.Redis.ServerVersion}}</code>{{else}}-{{end}}</div>
          <div class="muted">{{.T "system.redis.uptime"}}</div>
          <div>{{if gt .Redis.UptimeSeconds 0}}<code>{{.Redis.UptimeSeconds}}</code> {{.T "system.seconds"}}{{else}}-{{end}}</div>
          <div class="muted">{{.T "system.redis.clients"}}</div>
          <div>{{if gt .Redis.ConnectedClients 0}}<code>{{.Redis.ConnectedClients}}</code>{{else}}-{{end}}</div>
          <div class="muted">{{.T "system.redis.usedMemory"}}</div>
          <div>{{if .Redis.UsedMemoryHuman}}<code>{{.Redis.UsedMemoryHuman}}</code>{{else}}-{{end}}</div>
          <div class="muted">{{.T "system.redis.dbSize"}}</div>
          <div><code>{{.Redis.DBSize}}</code> {{.T "system.redis.keys"}}</div>
        </div>
      {{else if eq .Redis.Status "error"}}
        <div class="pill err">{{.T "redis.error"}} · <code>{{.Redis.Addr}}</code></div>
        {{if .Redis.Error}}<div class="muted small" style="margin-top:10px;">{{.T "common.errorPrefix"}}：{{.Redis.Error}}</div>{{end}}
      {{else}}
        <div class="pill">{{.T "redis.notConfigured"}}</div>
      {{end}}
    </div>
  </div>
{{end}}
