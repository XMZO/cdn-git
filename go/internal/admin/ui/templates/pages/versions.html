{{define "versions"}}
  <div class="grid">
    <div class="card">
      <h2>版本 & 备份</h2>
      <div class="muted small">每次保存配置都会写入一条版本记录（SQLite）。可导出/导入 JSON 备份。</div>
      <div class="btn-row">
        <a class="btn" href="/config/export">下载备份（export）</a>
        <a class="btn" href="/config/import">导入备份（import）</a>
      </div>
    </div>

    <div class="card">
      <h3>历史版本</h3>
      {{if not .Versions}}
        <div class="muted small">暂无版本</div>
      {{else}}
        <div class="table-wrap">
          <table class="table">
            <thead>
              <tr>
                <th>ID</th>
                <th>时间</th>
                <th>用户</th>
                <th>备注</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody>
              {{range .Versions}}
                <tr>
                  <td><code>{{.ID}}</code></td>
                  <td>{{.CreatedAt}}</td>
                  <td>{{if .CreatedBy}}{{.CreatedBy}}{{else}}-{{end}}</td>
                  <td>{{.Note}}</td>
                  <td>
                    <form method="post" action="/config/versions/{{.ID}}/restore" style="margin:0;">
                      <button class="btn" type="submit" onclick="return confirm('确定回滚到该版本？这会立即生效。');">回滚</button>
                    </form>
                  </td>
                </tr>
              {{end}}
            </tbody>
          </table>
        </div>
      {{end}}
    </div>
  </div>
{{end}}
